<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ë—É–Ω–∫–µ—Ä</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #000; color: white; font-family: Arial; min-height: 100vh; }
        .header { width: 100%; height: 33vh; overflow: hidden; }
        .header img { width: 100%; height: 100%; object-fit: cover; }
        .content { padding: 20px; text-align: center; }
        
        /* –°–æ–æ–±—â–µ–Ω–∏—è */
        .message { padding: 10px; margin: 10px auto; max-width: 600px; border-radius: 5px; }
        .error { background: #330000; color: #ff6666; border: 1px solid #660000; }
        .success { background: #003300; color: #66ff66; border: 1px solid #006600; }
        .info { background: #003366; color: #66aaff; border: 1px solid #0066cc; }
        
        /* –ö–Ω–æ–ø–∫–∏ */
        .btn { display: inline-block; padding: 12px 24px; margin: 10px; 
               background: #007bff; color: white; text-decoration: none; 
               border-radius: 5px; font-size: 16px; cursor: pointer; border: none; }
        .btn:hover { background: #0056cc; }
        .btn-create { background: #28a745; }
        .btn-create:hover { background: #1e7e34; }
        .btn-logout { background: #dc3545; }
        .btn-logout:hover { background: #c82333; }
        
        /* –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã */
        .create-room-form { max-width: 500px; margin: 30px auto; padding: 20px; 
                            background: #222; border-radius: 10px; }
        .create-room-form input { width: 70%; padding: 10px; margin-right: 10px; 
                                  background: #333; border: 1px solid #444; 
                                  color: white; border-radius: 5px; }
        
        /* –°–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç */
        .rooms-container { max-width: 800px; margin: 30px auto; }
        .room-section { background: #1a1a1a; border-radius: 10px; padding: 20px; margin: 20px 0; }
        .room-section h3 { color: #007bff; margin-bottom: 15px; }
        .room-card { background: #222; padding: 15px; margin: 10px 0; 
                     border-radius: 8px; border-left: 4px solid #007bff; }
        .room-card h4 { margin: 0 0 10px 0; color: #ddd; }
        .room-card p { margin: 5px 0; color: #aaa; font-size: 14px; }
        .room-actions { margin-top: 10px; }
        .room-link { display: inline-block; background: #333; color: #ddd; 
                     padding: 8px 15px; border-radius: 5px; margin-right: 10px; 
                     font-size: 14px; text-decoration: none; }
        .room-link:hover { background: #444; }
        
        /* –î–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö */
        .auth-buttons { margin-top: 40px; }
    </style>
</head>
<body>
    <div class="header">
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcReJrukummfeWNALFc6zotq8HDzXDRq8siX0g&s" alt="–ë—É–Ω–∫–µ—Ä">
    </div>
    
    <div class="content">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="message {{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        {% if username %}
            <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∫–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞ -->
            <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ username }}!</h1>
            <a href="/logout" class="btn btn-logout">–í—ã–π—Ç–∏</a>
            
            <!-- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã -->
            <div class="create-room-form">
                <h2>–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</h2>
                <form method="POST" action="/create_room">
                    <input type="text" name="room_name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã" required>
                    <button type="submit" class="btn btn-create">–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
                </form>
                <p style="color: #888; margin-top: 10px;">
                    –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–º–Ω–∞—Ç—É –∏ –ø—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –¥—Ä—É–∑–µ–π
                </p>
            </div>
            
            <!-- –ú–æ–∏ –∫–æ–º–Ω–∞—Ç—ã -->
            {% if my_rooms %}
            <div class="rooms-container">
                <div class="room-section">
                    <h3>üéÆ –ú–æ–∏ –∫–æ–º–Ω–∞—Ç—ã</h3>
                    {% for room in my_rooms %}
                    <div class="room-card">
                        <h4>{{ room[1] }}</h4>
                        <p>ID: {{ room[0] }}</p>
                        <div class="room-actions">
                            <a href="/room/{{ room[0] }}" class="room-link">–í–æ–π—Ç–∏</a>
                            <a href="/join/{{ room[0] }}" class="room-link">–°—Å—ã–ª–∫–∞ –¥–ª—è –¥—Ä—É–∑–µ–π</a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
            
            <!-- –ö–æ–º–Ω–∞—Ç—ã –≥–¥–µ —è —É—á–∞—Å—Ç–Ω–∏–∫ -->
            {% if joined_rooms %}
            <div class="rooms-container">
                <div class="room-section">
                    <h3>üë• –£—á–∞—Å—Ç–≤—É—é –≤ –∫–æ–º–Ω–∞—Ç–∞—Ö</h3>
                    {% for room in joined_rooms %}
                    <div class="room-card">
                        <h4>{{ room[1] }}
                            {% if room[3] %}
                            <span style="color: #28a745; font-size: 12px;">üéÆ –ò–≥—Ä–∞ –∏–¥–µ—Ç</span>
                            {% endif %}
                        </h4>
                        <p>–°–æ–∑–¥–∞–ª: {{ room[2] }} | ID: {{ room[0] }}</p>
                        <div class="room-actions">
                            <a href="/room/{{ room[0] }}" class="room-link">–í–æ–π—Ç–∏</a>
                            <a href="/leave_room/{{ room[0] }}" class="room-link" style="background: #660000;">–ü–æ–∫–∏–Ω—É—Ç—å</a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
            
            {% if not my_rooms and not joined_rooms %}
            <div style="margin: 40px 0; color: #888;">
                <p>–£ –≤–∞—Å –µ—â–µ –Ω–µ—Ç –∫–æ–º–Ω–∞—Ç. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é!</p>
            </div>
            {% endif %}
            
        {% else %}
            <!-- –î–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö -->
            <h1>–ë—É–Ω–∫–µ—Ä</h1>
            <p style="color: #aaa; margin: 20px 0;">–ò–≥—Ä–∞ –≤ —Ä–æ–ª–∏ —Å –¥—Ä—É–∑—å—è–º–∏</p>
            
            <div class="auth-buttons">
                <a href="/register" class="btn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
                <a href="/login" class="btn">–í—Ö–æ–¥</a>
            </div>
            
            <div style="margin-top: 50px; color: #666; max-width: 600px; margin-left: auto; margin-right: auto;">
                <h3>üé≠ 6 —Ä–æ–ª–µ–π:</h3>
                <p>–ü–æ–≤–∞—Ä, –ü–æ–ª–∏—Ü–µ–π—Å–∫–∏–π, –£—á–µ–Ω—ã–π, –ë–∏–æ–ª–æ–≥, –§–∏–∑–∏–∫, –°–ø–æ—Ä—Ç—Å–º–µ–Ω</p>
            </div>
        {% endif %}
    </div>
</body>
</html>