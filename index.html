<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ –ë—É–Ω–∫–µ—Ä - –ò–≥—Ä–∞ –≤ —Ä–æ–ª–∏</title>
    <style>
        /* –ß–ï–†–ù–´–ô –§–û–ù –ò –ö–ê–†–¢–ò–ù–ö–ê –°–í–ï–†–•–£ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: #000000;
            color: white;
            font-family: Arial, sans-serif;
            min-height: 100vh;
        }
        
        /* –ö–∞—Ä—Ç–∏–Ω–∫–∞ —Å–≤–µ—Ä—Ö—É –Ω–∞ 1/3 —ç–∫—Ä–∞–Ω–∞ */
        .header-image {
            width: 100%;
            height: 33vh; /* –¢—Ä–µ—Ç—å —ç–∫—Ä–∞–Ω–∞ */
            background: #222;
            position: relative;
            overflow: hidden;
        }
        
        .header-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .header-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
        }
        
        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: #fff;
            text-align: center;
        }
        
        h2 {
            color: #4CAF50;
            margin: 30px 0 15px 0;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            display: inline-block;
            background: #4CAF50;
            color: white;
            padding: 14px 28px;
            margin: 10px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .btn:hover {
            background: #45a049;
            transform: translateY(-2px);
        }
        
        .btn-register {
            background: #2196F3;
        }
        
        .btn-register:hover {
            background: #0b7dda;
        }
        
        /* –§–æ—Ä–º—ã */
        .form-container {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            border: 1px solid #333;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #ccc;
        }
        
        input {
            width: 100%;
            padding: 12px 15px;
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 6px;
            color: white;
            font-size: 16px;
        }
        
        input:focus {
            outline: none;
            border-color: #4CAF50;
        }
        
        /* –†–æ–ª–∏ */
        .roles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .role-card {
            background: #222;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border-left: 4px solid #4CAF50;
        }
        
        /* –°–æ–æ–±—â–µ–Ω–∏—è */
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .alert-success {
            background: #1b5e20;
            color: #a5d6a7;
            border: 1px solid #2e7d32;
        }
        
        .alert-error {
            background: #5d0000;
            color: #ff8a8a;
            border: 1px solid #c62828;
        }
        
        /* –§—É—Ç–µ—Ä */
        footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            color: #666;
            border-top: 1px solid #333;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .btn {
                padding: 12px 24px;
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <!-- –ö–∞—Ä—Ç–∏–Ω–∫–∞ —Å–≤–µ—Ä—Ö—É -->
    <div class="header-image">
        <img src="https://images.unsplash.com/photo-1585208798170-4332c8c64c85?ixlib=rb-1.2.1&auto=format&fit=crop&w=1200&q=80" 
             alt="–ß–µ–ª–æ–≤–µ–∫ –≤ –ø—Ä–æ—Ç–∏–≤–æ–≥–∞–∑–µ —É –±—É–Ω–∫–µ—Ä–∞">
        <div class="header-overlay">
            <h1>üéÆ –ë–£–ù–ö–ï–†</h1>
            <p style="color: #ccc; font-size: 1.2rem;">–ò–≥—Ä–∞ –≤ —Ä–æ–ª–∏ —Å –¥—Ä—É–∑—å—è–º–∏</p>
        </div>
    </div>
    
    <div class="container">
        <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ -->
        <div style="text-align: center; margin-bottom: 40px;">
            <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É!</h2>
            <p style="color: #aaa; font-size: 1.1rem; line-height: 1.6;">
                –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∫–æ–º–Ω–∞—Ç—ã, –ø—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π, –ø–æ–ª—É—á–∞–π—Ç–µ —Å–ª—É—á–∞–π–Ω—ã–µ —Ä–æ–ª–∏ –∏ –∏–≥—Ä–∞–π—Ç–µ –≤–º–µ—Å—Ç–µ!
            </p>
        </div>
        
        <!-- –ö–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
        <div style="text-align: center; margin: 40px 0;">
            <button class="btn btn-register" onclick="showRegister()">üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            <button class="btn" onclick="showLogin()">üîë –í—Ö–æ–¥</button>
        </div>
        
        <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
        <div id="register-form" class="form-container" style="display: none;">
            <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
            <div class="form-group">
                <label for="username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                <input type="text" id="username" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–∏–∫–Ω–µ–π–º" required>
            </div>
            
            <div class="form-group">
                <label for="password">–ü–∞—Ä–æ–ª—å:</label>
                <input type="password" id="password" placeholder="–ù–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤" required>
            </div>
            
            <div class="form-group">
                <label for="confirm-password">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å:</label>
                <input type="password" id="confirm-password" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
            </div>
            
            <button class="btn" onclick="register()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            <button class="btn" style="background: #666;" onclick="hideForms()">–û—Ç–º–µ–Ω–∞</button>
            
            <div id="register-message" class="alert" style="display: none;"></div>
        </div>
        
        <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
        <div id="login-form" class="form-container" style="display: none;">
            <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
            <div class="form-group">
                <label for="login-username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                <input type="text" id="login-username" placeholder="–í–∞—à –Ω–∏–∫–Ω–µ–π–º" required>
            </div>
            
            <div class="form-group">
                <label for="login-password">–ü–∞—Ä–æ–ª—å:</label>
                <input type="password" id="login-password" placeholder="–í–∞—à –ø–∞—Ä–æ–ª—å" required>
            </div>
            
            <button class="btn" onclick="login()">–í–æ–π—Ç–∏</button>
            <button class="btn" style="background: #666;" onclick="hideForms()">–û—Ç–º–µ–Ω–∞</button>
            
            <div id="login-message" class="alert" style="display: none;"></div>
        </div>
        
        <!-- –°–ø–∏—Å–æ–∫ —Ä–æ–ª–µ–π -->
        <div class="form-container">
            <h2>üé≠ –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–æ–ª–∏ (6)</h2>
            <div class="roles-grid">
                <div class="role-card">üë®‚Äçüç≥ –ü–æ–≤–∞—Ä</div>
                <div class="role-card">üëÆ –ü–æ–ª–∏—Ü–µ–π—Å–∫–∏–π</div>
                <div class="role-card">üë®‚Äçüî¨ –£—á–µ–Ω—ã–π</div>
                <div class="role-card">üë®‚Äçüî¨ –ë–∏–æ–ª–æ–≥</div>
                <div class="role-card">üë®‚Äçüî¨ –§–∏–∑–∏–∫</div>
                <div class="role-card">üèÉ –°–ø–æ—Ä—Ç—Å–º–µ–Ω</div>
            </div>
        </div>
        
        <!-- –ö–∞–∫ –∏–≥—Ä–∞—Ç—å -->
        <div class="form-container">
            <h2>üìñ –ö–∞–∫ –∏–≥—Ä–∞—Ç—å?</h2>
            <ol style="color: #ccc; line-height: 1.8; padding-left: 20px;">
                <li>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –∏–ª–∏ –≤–æ–π–¥–∏—Ç–µ</li>
                <li>–°–æ–∑–¥–∞–π—Ç–µ –∫–æ–º–Ω–∞—Ç—É –∏–ª–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç–µ—Å—å –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π</li>
                <li>–ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –¥—Ä—É–∑–µ–π (–æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∏–º —Å—Å—ã–ª–∫—É –Ω–∞ –∫–æ–º–Ω–∞—Ç—É)</li>
                <li>–ö–æ–≥–¥–∞ –≤—Å–µ —Å–æ–±—Ä–∞–ª–∏—Å—å - –Ω–∞—á–Ω–∏—Ç–µ –∏–≥—Ä—É</li>
                <li>–ö–∞–∂–¥—ã–π –ø–æ–ª—É—á–∏—Ç —Å–ª—É—á–∞–π–Ω—É—é —Ä–æ–ª—å</li>
                <li>–ò–≥—Ä–∞–π—Ç–µ –ø–æ —Å–≤–æ–∏–º —Ä–æ–ª—è–º!</li>
            </ol>
        </div>
        
        <!-- –ö–æ–º–Ω–∞—Ç—ã (–ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞) -->
        <div id="rooms-section" style="display: none;">
            <div class="form-container">
                <h2>üéÆ –í–∞—à–∏ –∫–æ–º–Ω–∞—Ç—ã</h2>
                <div id="rooms-list"></div>
                
                <div style="margin-top: 30px;">
                    <h3>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–æ–º–Ω–∞—Ç—É:</h3>
                    <input type="text" id="room-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã" style="margin-bottom: 15px;">
                    <button class="btn" onclick="createRoom()">–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <p>üéÆ –ë—É–Ω–∫–µ—Ä - –ò–≥—Ä–∞ –≤ —Ä–æ–ª–∏ | –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ</p>
        <p>–ß—Ç–æ–±—ã –∏–≥—Ä–∞—Ç—å –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å</p>
    </footer>

    <script>
        // –•—Ä–∞–Ω–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ localStorage
        const ROLES = ["üë®‚Äçüç≥ –ü–æ–≤–∞—Ä", "üëÆ –ü–æ–ª–∏—Ü–µ–π—Å–∫–∏–π", "üë®‚Äçüî¨ –£—á–µ–Ω—ã–π", "üë®‚Äçüî¨ –ë–∏–æ–ª–æ–≥", "üë®‚Äçüî¨ –§–∏–∑–∏–∫", "üèÉ –°–ø–æ—Ä—Ç—Å–º–µ–Ω"];
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤–æ—à–µ–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        function checkAuth() {
            const user = localStorage.getItem('currentUser');
            if (user) {
                showRooms();
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        function showRegister() {
            document.getElementById('register-form').style.display = 'block';
            document.getElementById('login-form').style.display = 'none';
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É –≤—Ö–æ–¥–∞
        function showLogin() {
            document.getElementById('login-form').style.display = 'block';
            document.getElementById('register-form').style.display = 'none';
        }
        
        // –°–∫—Ä—ã—Ç—å –≤—Å–µ —Ñ–æ—Ä–º—ã
        function hideForms() {
            document.getElementById('register-form').style.display = 'none';
            document.getElementById('login-form').style.display = 'none';
        }
        
        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
        function register() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const confirm = document.getElementById('confirm-password').value;
            const message = document.getElementById('register-message');
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∏
            if (username.length < 3) {
                showMessage(message, '–ò–º—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 3 —Å–∏–º–≤–æ–ª–æ–≤', 'error');
                return;
            }
            
            if (password.length < 6) {
                showMessage(message, '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç 6 —Å–∏–º–≤–æ–ª–æ–≤', 'error');
                return;
            }
            
            if (password !== confirm) {
                showMessage(message, '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç', 'error');
                return;
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const users = JSON.parse(localStorage.getItem('bunker_users') || '{}');
            
            if (users[username]) {
                showMessage(message, '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç', 'error');
                return;
            }
            
            users[username] = {
                password: password,
                created: new Date().toISOString(),
                rooms: []
            };
            
            localStorage.setItem('bunker_users', JSON.stringify(users));
            localStorage.setItem('currentUser', username);
            
            showMessage(message, '‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!', 'success');
            
            // –û—á–∏—â–∞–µ–º –ø–æ–ª—è
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            document.getElementById('confirm-password').value = '';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–º–Ω–∞—Ç—ã —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                hideForms();
                showRooms();
            }, 2000);
        }
        
        // –í—Ö–æ–¥
        function login() {
            const username = document.getElementById('login-username').value.trim();
            const password = document.getElementById('login-password').value;
            const message = document.getElementById('login-message');
            
            const users = JSON.parse(localStorage.getItem('bunker_users') || '{}');
            
            if (users[username] && users[username].password === password) {
                localStorage.setItem('currentUser', username);
                showMessage(message, '‚úÖ –í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω!', 'success');
                
                setTimeout(() => {
                    hideForms();
                    showRooms();
                }, 1500);
            } else {
                showMessage(message, '‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å', 'error');
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–º–Ω–∞—Ç—ã
        function showRooms() {
            const user = localStorage.getItem('currentUser');
            if (!user) return;
            
            document.getElementById('rooms-section').style.display = 'block';
            loadRooms();
        }
        
        // –°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É
        function createRoom() {
            const user = localStorage.getItem('currentUser');
            if (!user) {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É!');
                return;
            }
            
            const roomName = document.getElementById('room-name').value || `–ö–æ–º–Ω–∞—Ç–∞ ${user}`;
            const roomId = 'room_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–º–Ω–∞—Ç—É
            const rooms = JSON.parse(localStorage.getItem('bunker_rooms') || '{}');
            rooms[roomId] = {
                name: roomName,
                owner: user,
                members: [user],
                gameStarted: false,
                roles: {},
                createdAt: new Date().toISOString()
            };
            
            localStorage.setItem('bunker_rooms', JSON.stringify(rooms));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Å—ã–ª–∫—É
            const roomUrl = `${window.location.origin}${window.location.pathname}?room=${roomId}`;
            
            alert(`üéÆ –ö–æ–º–Ω–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞!\n\n–ù–∞–∑–≤–∞–Ω–∏–µ: ${roomName}\n\n–°—Å—ã–ª–∫–∞ –¥–ª—è –¥—Ä—É–∑–µ–π:\n${roomUrl}\n\n–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –¥—Ä—É–∑—å—è–º!`);
            
            document.getElementById('room-name').value = '';
            loadRooms();
        }
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–º–Ω–∞—Ç—ã
        function loadRooms() {
            const user = localStorage.getItem('currentUser');
            const rooms = JSON.parse(localStorage.getItem('bunker_rooms') || '{}');
            const roomsList = document.getElementById('rooms-list');
            
            roomsList.innerHTML = '';
            
            let hasRooms = false;
            
            Object.entries(rooms).forEach(([id, room]) => {
                if (room.members.includes(user)) {
                    hasRooms = true;
                    const roomDiv = document.createElement('div');
                    roomDiv.style.background = '#2a2a2a';
                    roomDiv.style.padding = '15px';
                    roomDiv.style.margin = '10px 0';
                    roomDiv.style.borderRadius = '8px';
                    roomDiv.style.borderLeft = '4px solid #4CAF50';
                    
                    roomDiv.innerHTML = `
                        <h3 style="margin: 0 0 10px 0;">${room.name} ${room.owner === user ? 'üëë' : ''}</h3>
                        <p style="color: #aaa; margin: 5px 0;">–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: ${room.members.length}/6</p>
                        <p style="color: #aaa; margin: 5px 0;">–°–æ–∑–¥–∞—Ç–µ–ª—å: ${room.owner}</p>
                        <p style="color: ${room.gameStarted ? '#4CAF50' : '#ff9800'}; margin: 5px 0;">
                            ${room.gameStarted ? 'üéÆ –ò–≥—Ä–∞ –∏–¥–µ—Ç' : '‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ'}
                        </p>
                        <button onclick="enterRoom('${id}')" 
                                style="background: #2196F3; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-top: 10px;">
                            –í–æ–π—Ç–∏ –≤ –∫–æ–º–Ω–∞—Ç—É
                        </button>
                        ${room.owner === user ? `
                            <button onclick="shareRoom('${id}')" 
                                    style="background: #9C27B0; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-top: 10px; margin-left: 10px;">
                                üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É
                            </button>
                        ` : ''}
                    `;
                    
                    roomsList.appendChild(roomDiv);
                }
            });
            
            if (!hasRooms) {
                roomsList.innerHTML = '<p style="color: #666; text-align: center;">–£ –≤–∞—Å –µ—â–µ –Ω–µ—Ç –∫–æ–º–Ω–∞—Ç. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é!</p>';
            }
        }
        
        // –í–æ–π—Ç–∏ –≤ –∫–æ–º–Ω–∞—Ç—É
        function enterRoom(roomId) {
            window.location.href = `?room=${roomId}`;
        }
        
        // –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –∫–æ–º–Ω–∞—Ç–æ–π
        function shareRoom(roomId) {
            const roomUrl = `${window.location.origin}${window.location.pathname}?room=${roomId}`;
            navigator.clipboard.writeText(roomUrl).then(() => {
                alert('‚úÖ –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞! –û—Ç–ø—Ä–∞–≤—å—Ç–µ –¥—Ä—É–∑—å—è–º.');
            }).catch(() => {
                prompt('–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç—É —Å—Å—ã–ª–∫—É:', roomUrl);
            });
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
        function showMessage(element, text, type) {
            element.textContent = text;
            element.className = `alert alert-${type}`;
            element.style.display = 'block';
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã URL
        function checkUrlParams() {
            const urlParams = new URLSearchParams(window.location.search);
            const roomId = urlParams.get('room');
            
            if (roomId) {
                showRoomPage(roomId);
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–æ–º–Ω–∞—Ç—ã
        function showRoomPage(roomId) {
            const rooms = JSON.parse(localStorage.getItem('bunker_rooms') || '{}');
            const room = rooms[roomId];
            const user = localStorage.getItem('currentUser');
            
            if (!room) {
                document.body.innerHTML = `
                    <div style="text-align: center; padding: 100px 20px;">
                        <h1 style="color: white;">–ö–æ–º–Ω–∞—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</h1>
                        <a href="?" style="color: #4CAF50; font-size: 18px;">–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>
                    </div>
                `;
                return;
            }
            
            // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤ –∫–æ–º–Ω–∞—Ç–µ - –¥–æ–±–∞–≤–ª—è–µ–º
            if (user && !room.members.includes(user)) {
                room.members.push(user);
                localStorage.setItem('bunker_rooms', JSON.stringify(rooms));
            }
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–æ–º–Ω–∞—Ç—ã
            document.body.innerHTML = `
                <div class="header-image">
                    <img src="https://images.unsplash.com/photo-1585208798170-4332c8c64c85?w=1200&q=80" alt="–ë—É–Ω–∫–µ—Ä">
                    <div class="header-overlay">
                        <h1>üéÆ ${room.name}</h1>
                        <p style="color: #ccc;">–ö–æ–º–Ω–∞—Ç–∞ ID: ${roomId.substr(0, 10)}...</p>
                    </div>
                </div>
                
                <div class="container">
                    <div class="form-container">
                        <h2>${room.name}</h2>
                        <p><strong>–°–æ–∑–¥–∞—Ç–µ–ª—å:</strong> ${room.owner} ${room.owner === user ? '(–í—ã)' : ''}</p>
                        <p><strong>–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤:</strong> ${room.members.length}/6</p>
                        <p><strong>–°—Ç–∞—Ç—É—Å:</strong> ${room.gameStarted ? 'üéÆ –ò–≥—Ä–∞ –∏–¥–µ—Ç' : '‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤'}</p>
                        
                        ${room.owner === user && !room.gameStarted ? `
                            <button onclick="startGame('${roomId}')" 
                                    style="background: #4CAF50; color: white; border: none; padding: 15px 30px; border-radius: 8px; font-size: 18px; cursor: pointer; margin: 20px 0; width: 100%;">
                                üéÆ –ù–ê–ß–ê–¢–¨ –ò–ì–†–£
                            </button>
                        ` : ''}
                        
                        ${room.gameStarted && room.roles[user] ? `
                            <div style="background: #1b5e20; padding: 25px; border-radius: 10px; margin: 25px 0; text-align: center;">
                                <h3>üé≠ –í–∞—à–∞ —Ä–æ–ª—å:</h3>
                                <h1 style="color: #ffd700; font-size: 2.5rem; margin: 15px 0;">${room.roles[user]}</h1>
                                <p style="color: #a5d6a7;">–î–µ—Ä–∂–∏—Ç–µ —Å–≤–æ—é —Ä–æ–ª—å –≤ —Å–µ–∫—Ä–µ—Ç–µ!</p>
                            </div>
                        ` : room.gameStarted && !room.roles[user] ? `
                            <button onclick="getRole('${roomId}')" 
                                    style="background: #2196F3; color: white; border: none; padding: 15px 30px; border-radius: 8px; font-size: 18px; cursor: pointer; margin: 20px 0; width: 100%;">
                                üîç –£–ó–ù–ê–¢–¨ –°–í–û–Æ –†–û–õ–¨
                            </button>
                        ` : ''}
                    </div>
                    
                    <div class="form-container">
                        <h2>üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏ –∫–æ–º–Ω–∞—Ç—ã (${room.members.length})</h2>
                        <div id="members-list">
                            ${room.members.map(member => `
                                <div style="background: #2a2a2a; padding: 12px; margin: 8px 0; border-radius: 6px; border-left: 4px solid ${member === room.owner ? '#ff9800' : '#4CAF50'};">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <strong>${member}</strong>
                                            ${member === room.owner ? ' üëë' : ''}
                                            ${member === user ? ' (–í—ã)' : ''}
                                        </div>
                                        ${room.gameStarted && room.roles[member] && (member === user || room.owner === user) ? `
                                            <span style="background: #333; padding: 4px 10px; border-radius: 4px; font-size: 14px;">
                                                ${room.roles[member]}
                                            </span>
                                        ` : ''}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 40px;">
                        <a href="?" style="display: inline-block; background: #666; color: white; padding: 12px 24px; border-radius: 6px; text-decoration: none; margin: 5px;">
                            ‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é
                        </a>
                        <button onclick="shareRoom('${roomId}')" 
                                style="background: #9C27B0; color: white; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; margin: 5px;">
                            üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É
                        </button>
                    </div>
                </div>
                
                <script>
                    function startGame(roomId) {
                        const rooms = JSON.parse(localStorage.getItem('bunker_rooms') || '{}');
                        const room = rooms[roomId];
                        
                        if (room.members.length < 2) {
                            alert('–î–ª—è –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 —É—á–∞—Å—Ç–Ω–∏–∫–∞!');
                            return;
                        }
                        
                        if (room.members.length > ${ROLES.length}) {
                            alert('–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤! –ú–∞–∫—Å–∏–º—É–º ${ROLES.length} —á–µ–ª–æ–≤–µ–∫.');
                            return;
                        }
                        
                        // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º —Ä–æ–ª–∏
                        const shuffledRoles = [...${JSON.stringify(ROLES)}].sort(() => Math.random() - 0.5);
                        
                        // –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–æ–ª–∏
                        room.members.forEach((member, index) => {
                            if (index < shuffledRoles.length) {
                                room.roles[member] = shuffledRoles[index];
                            }
                        });
                        
                        room.gameStarted = true;
                        rooms[roomId] = room;
                        localStorage.setItem('bunker_rooms', JSON.stringify(rooms));
                        
                        location.reload();
                    }
                    
                    function getRole(roomId) {
                        const rooms = JSON.parse(localStorage.getItem('bunker_rooms') || '{}');
                        const room = rooms[roomId];
                        const user = '${user}';
                        
                        if (room.roles[user]) {
                            location.reload();
                        } else {
                            alert('–†–æ–ª—å –µ—â–µ –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞!');
                        }
                    }
                    
                    function shareRoom(roomId) {
                        const roomUrl = window.location.origin + window.location.pathname + '?room=' + roomId;
                        navigator.clipboard.writeText(roomUrl).then(() => {
                            alert('‚úÖ –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞! –û—Ç–ø—Ä–∞–≤—å—Ç–µ –¥—Ä—É–∑—å—è–º.');
                        });
                    }
                </script>
            `;
        }
        
        // –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            checkAuth();
            checkUrlParams();
        };
    </script>
</body>
</html>
